version: 7.0.3.{build}
branches:
  only:
  - develop7
configuration: release
image: Visual Studio 2022
init:
- ps: >-
    Update-AppveyorBuild -Version "7.0.3.$env:appveyor_build_number-$(Get-Date -format yyyyMMdd)-$env:appveyor_repo_branch"

    Write-Host "7.0.3.$env:appveyor_build_number-$(Get-Date -format yyyyMMdd)-$env:appveyor_repo_branch"
install:
- ps: |
    Invoke-WebRequest -Uri 'https://dot.net/v1/dotnet-install.ps1' -UseBasicParsing -OutFile "$env:temp\dotnet-install.ps1"
    & "$env:temp\dotnet-install.ps1" -Architecture x64 -Version '8.0.100' -InstallDir "$env:ProgramFiles\dotnet" 
dotnet_csproj:
  patch: true
  file: '**\*.csproj'
  version: '{version}'
  assembly_version: 7.0.3.{build}
  file_version: 7.0.3.{build}
nuget:
  project_feed: true
before_build:
- cmd: dotnet restore ./src/EPPlus.sln
build:
  verbosity: minimal
artifacts:
- path: '**\*.nupkg'
  name: EPPlus Nuget Package